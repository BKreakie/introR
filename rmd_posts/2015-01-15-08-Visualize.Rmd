---
title: "08 - Visualize"
author: Jeffrey W. Hollister
layout: post_page
---

```{r setup, echo=FALSE, warning=FALSE, purl=FALSE}
options(repos="http://cran.rstudio.com/")
if(!require("ggplot2")){
  install.packages("ggplot2")
}
library("ggplot2")
```

One of the frequently touted strong points of R is data visualization.  We saw some of that with our use of base graphics, but those plots were, frankly, a bit pedestrian.  More and more though, users are moving away from base graphics and using the`ggplot2` package.  I would even go as far to say that it is almost become the default plotting mechanism in R.  This whole lesson we will focus on creating, modifying, and save plots with `ggplot2`.

##Quick Links to Exercises and R code
- [Lesson 8 R Code](/gedr/rmd_posts/2015-01-14-08-Visualize.R): All the code from this post in an R Script.
- [Exercise 1](#exercise-1): Create a number of styles of plots
- [Exercise 2](#exercise-2): Build a plot, using custom themes, and save as a jpeg.

##Lesson Goals
- Become familar with some basic plots in `ggplot2`
- Be able to manipulate the default themes
- Output plots to files

A lot has been written and discussed about `ggplot2`.  In particular see [here](http://ggplot2.org/), [here](http://docs.ggplot2.org/current/) and [here](https://github.com/karthikram/ggplot-lecture).  The gist of all this, is that `ggplot2` is an implementation of something known as the "grammar of graphics."  This separates the basic components of a graphic into distinct parts (e.g. like the parts of speach in a sentence).  You add these parts together and get a figure.

Before we start developing some graphics, we need to do a bit of package maintenance as `ggplot2` is not installed by default.

```{r ggplot_install, eval=FALSE}
install.packages("ggplot2")
library("ggplot2")
```

First we create our ggplot object.  Everything we do will build off of this.  

```{r eval=FALSE}
# aes() are the "aesthetics" info.  When you simply add the x and y
# that can seem a bit of a confusing term.  You also use aes() to 
# change color, shape, size etc. of some items 
ggDf<-ggplot(df,aes(x=x,y=z))
```

So if we want to simply plot a scatterplot we can add it to the ggplot object.  These are known as the geometries.

```{r eval=FALSE}
# Different syntax than you are used to
ggDf + 
  geom_point()
```

Not appreciably better than base, in my opinion.  But what if we want to add some stuff...

First a title and some axes labels.  These are part of scale.

```{r eval=FALSE}
ggDf +
  labs(title="My First ggplot2 Figure",x="My Random X", y="My Random Y") +
  geom_point()
```

Now to add some colors, shapes etc to the point.  Look at the geom_point() documentation for this.

```{r eval=FALSE}
ggDf +
  labs(title="My First ggplot2 Figure",x="My Random X", y="My Random Y") +
  geom_point(aes(color=xf, shape=xf),size=5)
```

Much easier that using base.  Now `ggplot2` really shines when you want to add stats (regression lines, intervals, etc.). 

Lets add a loess line with 95% confidence intervals

```{r eval=FALSE}
ggDf +
  labs(title="My First ggplot2 Figure",x="My Random X", y="My Random Y") +
  geom_point(aes(color=xf, shape=xf),size=5)+
  geom_smooth()
```

Try that in `base` with four lines of code!

So a few other types of plots can be easily built with the same ggplot object.

boxplots

```{r eval=FALSE}
ggplot(df,aes(factor(xf),x)) +
  geom_boxplot()
```

Histogram

```{r eval=FALSE}
ggplot(df,aes(x=x))+
  geom_histogram(aes(fill=xf))
```

Barplots (FIX ME)

```{r eval=FALSE}
# I am not up-to-speed on reshape2 or plyr.  So for the time-being, melt is magic
library(reshape2)
library(plyr)
mdf<-ddply(melt(df),.(variable),summarise,
           meanVal = mean(value),
           low = mean(value) - sd(value)/sqrt(length(value)),
           high = mean(value) + sd(value)/sqrt(length(value)))
myBarChart<-ggplot(mdf,aes(x=factor(variable),y=meanVal,fill=variable))+
  geom_bar(stat="identity")+
  geom_errorbar(aes(ymin=low,ymax=high,width=0.3))+
  labs(title="Bar Plot with SE error bars", x="Treatment",
       y="Mean Response")

myBarChart
```

So, not spectacular yet, but with a bit more dithering, the plot would be publication ready, provided you could save it as an image file.  Well, you can do that too!

```{r eval=FALSE}
ggsave(plot=myBarChart,
       file="myBarChart.jpg")
```

## Data Viz Exercise
Write a documented function that creates a data visualization of the NLA data frame we have been working with.  Use your imagination!  When youa are done and have an image on your screen, raise your hands.  We will pick some favorites and show the rest of the class.

# R Data Viz Examples

- Base examples: [R Gallery]()
- ggplot examples: [Google Image Search](http://goo.gl/P0q2Lx)
- R Data Viz, gone wrong:[Accidental aRt](http://accidental-art.tumblr.com) 

##Exercise 1